local function getNearestPlayer()
    local players = game:GetService("Players"):GetPlayers()
    local localPlayer = game.Players.LocalPlayer
    local nearestPlayer = nil
    local shortestDistance = math.huge

    for _, player in ipairs(players) do
        if player ~= localPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local distance = (localPlayer.Character.HumanoidRootPart.Position - player.Character.HumanoidRootPart.Position).magnitude
            if distance < shortestDistance then
                shortestDistance = distance
                nearestPlayer = player
            end
        end
    end

    return nearestPlayer
end

local function getItems(player)
    local items = {}
    local backpack = player:FindFirstChild("Backpack")

    if backpack then
        for _, item in ipairs(backpack:GetChildren()) do
            if item:IsA("Tool") then
                table.insert(items, item.Name)
            end
        end
    end

    return items
end

local function sendMessageToNearestPlayer()
    local nearestPlayer = getNearestPlayer()

    if nearestPlayer then
        local items = getItems(nearestPlayer)
        local itemList

        if #items > 0 then
            itemList = table.concat(items, ", ")
        else
            itemList = "Not Found Any Item"
        end

        local args = {
            [1] = "[" .. nearestPlayer.Name .. "], Inventory Item: " .. itemList .. " !?",
            [2] = "All"
        }

        game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer(unpack(args))
    else
        print("No nearby players found.")
    end
end

sendMessageToNearestPlayer()
